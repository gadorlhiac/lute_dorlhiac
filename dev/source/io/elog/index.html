<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="author" content="GFD, VM" />
      <link rel="shortcut icon" href="../../../img/favicon.ico" />
    <title>elog - LUTE</title>
    <link rel="stylesheet" href="../../../css/theme.css" />
    <link rel="stylesheet" href="../../../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/styles/github.min.css" />
        <link href="../../../assets/_mkdocstrings.css" rel="stylesheet" />
        <link href="../../../css/version-select.css" rel="stylesheet" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "elog";
        var mkdocs_page_input_path = "source/io/elog.md";
        var mkdocs_page_url = null;
      </script>
    
    <script src="../../../js/jquery-3.6.0.min.js" defer></script>
    <!--[if lt IE 9]>
      <script src="../../../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/highlight.min.js"></script>
      <script>hljs.initHighlightingOnLoad();</script> 
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href="../../.." class="icon icon-home"> LUTE
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../../usage/">Quick Start</a>
                </li>
              </ul>
              <p class="caption"><span class="caption-text">Walkthroughs</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../../tutorial/new_task/">Creating a new Task</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../tutorial/creating_workflows/">Creating a new Workflow</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Source Code</span></p>
              <ul class="current">
                  <li class="toctree-l1"><a class="reference internal" href="../../managed_tasks/">managed_tasks</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="#">execution</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../../execution/executor/">executor</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../execution/ipc/">ipc</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../execution/debug_utils/">debug_utils</a>
                </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="#">tasks</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../../tasks/task/">task</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../tasks/dataclasses/">dataclasses</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../tasks/sfx_find_peaks/">sfx_find_peaks</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../tasks/sfx_index/">sfx_index</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../tasks/test/">test</a>
                </li>
    </ul>
                  </li>
                  <li class="toctree-l1 current"><a class="reference internal current" href="#">io</a>
    <ul class="current">
                <li class="toctree-l2"><a class="reference internal" href="#">models</a>
    <ul>
                <li class="toctree-l3"><a class="reference internal" href="../models/base/">base</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../models/sfx_find_peaks/">sfx_find_peaks</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../models/sfx_index/">sfx_index</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../models/sfx_merge/">sfx_merge</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../models/sfx_solve/">sfx_solve</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../models/smd/">smd</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../models/tests/">tests</a>
                </li>
    </ul>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../config/">config</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../db/">db</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../_sqlite/">_sqlite</a>
                </li>
                <li class="toctree-l2 current"><a class="reference internal current" href="./">elog</a>
    <ul class="current">
    </ul>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../exceptions/">exceptions</a>
                </li>
    </ul>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Design and Specifications</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../../design/database/">Database</a>
                  </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../..">LUTE</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../../.." class="icon icon-home" alt="Docs"></a> &raquo;</li>
          <li>Source Code &raquo;</li>
          <li>io &raquo;</li>
      <li>elog</li>
    <li class="wy-breadcrumbs-aside">
          <a href="https://github.com/slac-lcls/lute/edit/master/docs/source/io/elog.md" class="icon icon-github"> Edit on GitHub</a>
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <div class="doc doc-object doc-module">



<a id="io.elog"></a>
    <div class="doc doc-contents first">

      <p>Provides utilities for communicating with the LCLS eLog.</p>
<p>Make use of various eLog API endpoint to retrieve information or post results.</p>


<p><span class="doc-section-title">Functions:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="io.elog.get_elog_opr_auth" href="#io.elog.get_elog_opr_auth">get_elog_opr_auth</a></code></td>
              <td>
                <div class="doc-md-description">
                  <p>str): Return an authorization object to interact with
eLog API as an opr account for the hutch where <code>exp</code> was conducted.</p>
                </div>
              </td>
            </tr>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="io.elog.get_elog_kerberos_auth" href="#io.elog.get_elog_kerberos_auth">get_elog_kerberos_auth</a></code></td>
              <td>
                <div class="doc-md-description">
                  <p>Return the authorization headers for the user account
submitting the job.</p>
                </div>
              </td>
            </tr>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="io.elog.elog_http_request" href="#io.elog.elog_http_request">elog_http_request</a></code></td>
              <td>
                <div class="doc-md-description">
                  <p>str, request_type: str, **params): Make an HTTP
request to the API endpoint at <code>url</code>.</p>
                </div>
              </td>
            </tr>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="io.elog.format_file_for_post" href="#io.elog.format_file_for_post">format_file_for_post</a></code></td>
              <td>
                <div class="doc-md-description">
                  <p>Union[str, tuple, list]): Prepare files
according to the specification needed to add them as attachments to eLog
posts.</p>
                </div>
              </td>
            </tr>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="io.elog.post_elog_message" href="#io.elog.post_elog_message">post_elog_message</a></code></td>
              <td>
                <div class="doc-md-description">
                  <p>str, msg: str, tag: Optional[str],
              title: Optional[str],
              in_files: List[Union[str, tuple, list]],
              auth: Optional[Union[HTTPBasicAuth, Dict]] = None)
Post a message to the eLog.</p>
                </div>
              </td>
            </tr>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="io.elog.post_elog_run_status" href="#io.elog.post_elog_run_status">post_elog_run_status</a></code></td>
              <td>
                <div class="doc-md-description">
                  <p>Dict[str, Union[str, int, float]],
                 update_url: Optional[str] = None)
Post a run status to the summary section on the Workflows&gt;Control tab.</p>
                </div>
              </td>
            </tr>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="io.elog.post_elog_run_table" href="#io.elog.post_elog_run_table">post_elog_run_table</a></code></td>
              <td>
                <div class="doc-md-description">
                  <p>str, run: int, data: Dict[str, Any],
               auth: Optional[Union[HTTPBasicAuth, Dict]] = None)
Update run table in the eLog.</p>
                </div>
              </td>
            </tr>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="io.elog.get_elog_runs_by_tag" href="#io.elog.get_elog_runs_by_tag">get_elog_runs_by_tag</a></code></td>
              <td>
                <div class="doc-md-description">
                  <p>str, tag: str,
                 auth: Optional[Union[HTTPBasicAuth, Dict]] = None)
Return a list of runs with a specific tag.</p>
                </div>
              </td>
            </tr>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="io.elog.get_elog_params_by_run" href="#io.elog.get_elog_params_by_run">get_elog_params_by_run</a></code></td>
              <td>
                <div class="doc-md-description">
                  <p>str, params: List[str], runs: Optional[List[int]])
Retrieve the requested parameters by run. If no run is provided, retrieve
the requested parameters for all runs.</p>
                </div>
              </td>
            </tr>
      </tbody>
    </table>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h2 id="io.elog.elog_http_request" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">elog_http_request</span><span class="p">(</span><span class="n">exp</span><span class="p">,</span> <span class="n">endpoint</span><span class="p">,</span> <span class="n">request_type</span><span class="p">,</span> <span class="o">**</span><span class="n">params</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

      <p>Make an HTTP request to the eLog.</p>
<p>This method will determine the proper authorization method and update the
passed parameters appropriately. Functions implementing specific endpoint
functionality and calling this function should only pass the necessary
endpoint-specific parameters and not include the authorization objects.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>exp</code></b>
                  (<code>str</code>)
              –
              <div class="doc-md-description">
                <p>Experiment.</p>
              </div>
            </li>
            <li>
              <b><code>endpoint</code></b>
                  (<code>str</code>)
              –
              <div class="doc-md-description">
                <p>eLog API endpoint.</p>
              </div>
            </li>
            <li>
              <b><code>request_type</code></b>
                  (<code>str</code>)
              –
              <div class="doc-md-description">
                <p>Type of request to make. Recognized options: POST or
GET.</p>
              </div>
            </li>
            <li>
              <b><code>**params</code></b>
                  (<code><span title="typing.Dict">Dict</span></code>, default:
                      <code>{}</code>
)
              –
              <div class="doc-md-description">
                <p>Endpoint parameters to pass with the HTTP request!
Differs depending on the API endpoint. Do not include auth objects.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Returns:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
<b><code>status_code</code></b>(                  <code>int</code>
)              –
              <div class="doc-md-description">
                <p>Response status code. Can be checked for errors.</p>
              </div>
            </li>
            <li>
<b><code>msg</code></b>(                  <code>str</code>
)              –
              <div class="doc-md-description">
                <p>An error message, or a message saying SUCCESS.</p>
              </div>
            </li>
            <li>
<b><code>value</code></b>(                  <code><span title="typing.Optional">Optional</span>[<span title="typing.Any">Any</span>]</code>
)              –
              <div class="doc-md-description">
                <p>For GET requests ONLY, return the requested
information.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
            <details class="quote">
              <summary>Source code in <code>lute/io/elog.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">elog_http_request</span><span class="p">(</span>
    <span class="n">exp</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">endpoint</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">request_type</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">**</span><span class="n">params</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Any</span><span class="p">]]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Make an HTTP request to the eLog.</span>

<span class="sd">    This method will determine the proper authorization method and update the</span>
<span class="sd">    passed parameters appropriately. Functions implementing specific endpoint</span>
<span class="sd">    functionality and calling this function should only pass the necessary</span>
<span class="sd">    endpoint-specific parameters and not include the authorization objects.</span>

<span class="sd">    Args:</span>
<span class="sd">        exp (str): Experiment.</span>

<span class="sd">        endpoint (str): eLog API endpoint.</span>

<span class="sd">        request_type (str): Type of request to make. Recognized options: POST or</span>
<span class="sd">            GET.</span>

<span class="sd">        **params (Dict): Endpoint parameters to pass with the HTTP request!</span>
<span class="sd">            Differs depending on the API endpoint. Do not include auth objects.</span>

<span class="sd">    Returns:</span>
<span class="sd">        status_code (int): Response status code. Can be checked for errors.</span>

<span class="sd">        msg (str): An error message, or a message saying SUCCESS.</span>

<span class="sd">        value (Optional[Any]): For GET requests ONLY, return the requested</span>
<span class="sd">            information.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">auth</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">HTTPBasicAuth</span><span class="p">,</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="n">get_elog_auth</span><span class="p">(</span><span class="n">exp</span><span class="p">)</span>
    <span class="n">base_url</span><span class="p">:</span> <span class="nb">str</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">auth</span><span class="p">,</span> <span class="n">HTTPBasicAuth</span><span class="p">):</span>
        <span class="n">params</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s2">&quot;auth&quot;</span><span class="p">:</span> <span class="n">auth</span><span class="p">})</span>
        <span class="n">base_url</span> <span class="o">=</span> <span class="s2">&quot;https://pswww.slac.stanford.edu/ws-auth/lgbk/lgbk&quot;</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">auth</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
        <span class="n">params</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s2">&quot;headers&quot;</span><span class="p">:</span> <span class="n">auth</span><span class="p">})</span>
        <span class="n">base_url</span> <span class="o">=</span> <span class="s2">&quot;https://pswww.slac.stanford.edu/ws-kerb/lgbk/lgbk&quot;</span>

    <span class="n">url</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">base_url</span><span class="si">}</span><span class="s2">/</span><span class="si">{</span><span class="n">endpoint</span><span class="si">}</span><span class="s2">&quot;</span>

    <span class="n">resp</span><span class="p">:</span> <span class="n">requests</span><span class="o">.</span><span class="n">models</span><span class="o">.</span><span class="n">Response</span>
    <span class="k">if</span> <span class="n">request_type</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;POST&quot;</span><span class="p">:</span>
        <span class="n">resp</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="o">**</span><span class="n">params</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">request_type</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;GET&quot;</span><span class="p">:</span>
        <span class="n">resp</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="o">**</span><span class="n">params</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;Invalid request type!&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>

    <span class="n">status_code</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">resp</span><span class="o">.</span><span class="n">status_code</span>
    <span class="n">msg</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;SUCCESS&quot;</span>

    <span class="k">if</span> <span class="n">resp</span><span class="o">.</span><span class="n">json</span><span class="p">()[</span><span class="s2">&quot;success&quot;</span><span class="p">]</span> <span class="ow">and</span> <span class="n">request_type</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;GET&quot;</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">status_code</span><span class="p">,</span> <span class="n">msg</span><span class="p">,</span> <span class="n">resp</span><span class="o">.</span><span class="n">json</span><span class="p">()[</span><span class="s2">&quot;value&quot;</span><span class="p">])</span>

    <span class="k">if</span> <span class="n">status_code</span> <span class="o">&gt;=</span> <span class="mi">300</span><span class="p">:</span>
        <span class="n">msg</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Error when posting to eLog: Response </span><span class="si">{</span><span class="n">status_code</span><span class="si">}</span><span class="s2">&quot;</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">resp</span><span class="o">.</span><span class="n">json</span><span class="p">()[</span><span class="s2">&quot;success&quot;</span><span class="p">]:</span>
        <span class="n">err_msg</span> <span class="o">=</span> <span class="n">resp</span><span class="o">.</span><span class="n">json</span><span class="p">()[</span><span class="s2">&quot;error_msg&quot;</span><span class="p">]</span>
        <span class="n">msg</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Include message: </span><span class="si">{</span><span class="n">err_msg</span><span class="si">}</span><span class="s2">&quot;</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">resp</span><span class="o">.</span><span class="n">status_code</span><span class="p">,</span> <span class="n">msg</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="io.elog.format_file_for_post" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">format_file_for_post</span><span class="p">(</span><span class="n">in_file</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

      <p>Format a file for attachment to an eLog post.</p>
<p>The eLog API expects a specifically formatted tuple when adding file
attachments. This function prepares the tuple to specification given a
number of different input types.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>in_file</code></b>
                  (<code>str | tuple | list</code>)
              –
              <div class="doc-md-description">
                <p>File to include as an attachment in an
eLog post.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
            <details class="quote">
              <summary>Source code in <code>lute/io/elog.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">format_file_for_post</span><span class="p">(</span>
    <span class="n">in_file</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">,</span> <span class="nb">list</span><span class="p">]</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">BufferedReader</span><span class="p">],</span> <span class="n">Any</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Format a file for attachment to an eLog post.</span>

<span class="sd">    The eLog API expects a specifically formatted tuple when adding file</span>
<span class="sd">    attachments. This function prepares the tuple to specification given a</span>
<span class="sd">    number of different input types.</span>

<span class="sd">    Args:</span>
<span class="sd">        in_file (str | tuple | list): File to include as an attachment in an</span>
<span class="sd">            eLog post.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">description</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">fptr</span><span class="p">:</span> <span class="n">BufferedReader</span>
    <span class="n">ftype</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">in_file</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
        <span class="n">description</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">in_file</span><span class="p">)</span>
        <span class="n">fptr</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">in_file</span><span class="p">,</span> <span class="s2">&quot;rb&quot;</span><span class="p">)</span>
        <span class="n">ftype</span> <span class="o">=</span> <span class="n">mimetypes</span><span class="o">.</span><span class="n">guess_type</span><span class="p">(</span><span class="n">in_file</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">in_file</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">in_file</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
        <span class="n">description</span> <span class="o">=</span> <span class="n">in_file</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">fptr</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">in_file</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="s2">&quot;rb&quot;</span><span class="p">)</span>
        <span class="n">ftype</span> <span class="o">=</span> <span class="n">mimetypes</span><span class="o">.</span><span class="n">guess_type</span><span class="p">(</span><span class="n">in_file</span><span class="p">[</span><span class="mi">0</span><span class="p">])[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">ElogFileFormatError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Unrecognized format: </span><span class="si">{</span><span class="n">in_file</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="n">out_file</span><span class="p">:</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">BufferedReader</span><span class="p">],</span> <span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
        <span class="s2">&quot;files&quot;</span><span class="p">,</span>
        <span class="p">(</span><span class="n">description</span><span class="p">,</span> <span class="n">fptr</span><span class="p">),</span>
        <span class="n">ftype</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="k">return</span> <span class="n">out_file</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="io.elog.get_elog_active_expmt" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_elog_active_expmt</span><span class="p">(</span><span class="n">hutch</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">endstation</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

      <p>Get the current active experiment for a hutch.</p>
<p>This function is one of two functions to manage the HTTP request independently.
This is because it does not require an authorization object, and its result
is needed for the generic function <code>elog_http_request</code> to work properly.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>hutch</code></b>
                  (<code>str</code>)
              –
              <div class="doc-md-description">
                <p>The hutch to get the active experiment for.</p>
              </div>
            </li>
            <li>
              <b><code>endstation</code></b>
                  (<code>int</code>, default:
                      <code>0</code>
)
              –
              <div class="doc-md-description">
                <p>The hutch endstation to get the experiment for. This
should generally be 0.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
            <details class="quote">
              <summary>Source code in <code>lute/io/elog.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_elog_active_expmt</span><span class="p">(</span><span class="n">hutch</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">endstation</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Get the current active experiment for a hutch.</span>

<span class="sd">    This function is one of two functions to manage the HTTP request independently.</span>
<span class="sd">    This is because it does not require an authorization object, and its result</span>
<span class="sd">    is needed for the generic function `elog_http_request` to work properly.</span>

<span class="sd">    Args:</span>
<span class="sd">        hutch (str): The hutch to get the active experiment for.</span>

<span class="sd">        endstation (int): The hutch endstation to get the experiment for. This</span>
<span class="sd">            should generally be 0.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">base_url</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;https://pswww.slac.stanford.edu/ws/lgbk/lgbk&quot;</span>
    <span class="n">endpoint</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;ws/activeexperiment_for_instrument_station&quot;</span>
    <span class="n">url</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">base_url</span><span class="si">}</span><span class="s2">/</span><span class="si">{</span><span class="n">endpoint</span><span class="si">}</span><span class="s2">&quot;</span>
    <span class="n">params</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;instrument_name&quot;</span><span class="p">:</span> <span class="n">hutch</span><span class="p">,</span> <span class="s2">&quot;station&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">endstation</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">}</span>
    <span class="n">resp</span><span class="p">:</span> <span class="n">requests</span><span class="o">.</span><span class="n">models</span><span class="o">.</span><span class="n">Response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">params</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">resp</span><span class="o">.</span><span class="n">status_code</span> <span class="o">&gt;</span> <span class="mi">300</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;Error getting current experiment!</span><span class="se">\n\t\t</span><span class="s2">Incorrect hutch: &#39;</span><span class="si">{</span><span class="n">hutch</span><span class="si">}</span><span class="s2">&#39;?&quot;</span>
        <span class="p">)</span>
    <span class="k">if</span> <span class="n">resp</span><span class="o">.</span><span class="n">json</span><span class="p">()[</span><span class="s2">&quot;success&quot;</span><span class="p">]:</span>
        <span class="k">return</span> <span class="n">resp</span><span class="o">.</span><span class="n">json</span><span class="p">()[</span><span class="s2">&quot;value&quot;</span><span class="p">][</span><span class="s2">&quot;name&quot;</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">msg</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">resp</span><span class="o">.</span><span class="n">json</span><span class="p">()[</span><span class="s2">&quot;error_msg&quot;</span><span class="p">]</span>
        <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error getting current experiment! Err: </span><span class="si">{</span><span class="n">msg</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="io.elog.get_elog_auth" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_elog_auth</span><span class="p">(</span><span class="n">exp</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

      <p>Determine the appropriate auth method depending on experiment state.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Returns:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
<b><code>auth</code></b>(                  <code><span title="requests.auth.HTTPBasicAuth">HTTPBasicAuth</span> | <span title="typing.Dict">Dict</span>[str, str]</code>
)              –
              <div class="doc-md-description">
                <p>Depending on whether an experiment
is active/live, returns authorization for the hutch operator account
or the current user submitting a job.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
            <details class="quote">
              <summary>Source code in <code>lute/io/elog.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_elog_auth</span><span class="p">(</span><span class="n">exp</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="n">HTTPBasicAuth</span><span class="p">,</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Determine the appropriate auth method depending on experiment state.</span>

<span class="sd">    Returns:</span>
<span class="sd">        auth (HTTPBasicAuth | Dict[str, str]): Depending on whether an experiment</span>
<span class="sd">            is active/live, returns authorization for the hutch operator account</span>
<span class="sd">            or the current user submitting a job.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">hutch</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">exp</span><span class="p">[:</span><span class="mi">3</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">exp</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="n">get_elog_active_expmt</span><span class="p">(</span><span class="n">hutch</span><span class="o">=</span><span class="n">hutch</span><span class="p">)</span><span class="o">.</span><span class="n">lower</span><span class="p">():</span>
        <span class="k">return</span> <span class="n">get_elog_opr_auth</span><span class="p">(</span><span class="n">exp</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">get_elog_kerberos_auth</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="io.elog.get_elog_kerberos_auth" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_elog_kerberos_auth</span><span class="p">()</span></code>

</h2>


    <div class="doc doc-contents ">

      <p>Returns Kerberos authorization key.</p>
<p>This functions returns authorization for the USER account submitting jobs.
It assumes that <code>kinit</code> has been run.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Returns:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
<b><code>auth</code></b>(                  <code><span title="typing.Dict">Dict</span>[str, str]</code>
)              –
              <div class="doc-md-description">
                <p>Dictionary containing Kerberos authorization key.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
            <details class="quote">
              <summary>Source code in <code>lute/io/elog.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_elog_kerberos_auth</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Returns Kerberos authorization key.</span>

<span class="sd">    This functions returns authorization for the USER account submitting jobs.</span>
<span class="sd">    It assumes that `kinit` has been run.</span>

<span class="sd">    Returns:</span>
<span class="sd">        auth (Dict[str, str]): Dictionary containing Kerberos authorization key.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">from</span> <span class="nn">krtc</span> <span class="kn">import</span> <span class="n">KerberosTicket</span>

    <span class="k">return</span> <span class="n">KerberosTicket</span><span class="p">(</span><span class="s2">&quot;HTTP@pswww.slac.stanford.edu&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">getAuthHeaders</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="io.elog.get_elog_opr_auth" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_elog_opr_auth</span><span class="p">(</span><span class="n">exp</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

      <p>Produce authentication for the "opr" user associated to an experiment.</p>
<p>This method uses basic authentication using username and password.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>exp</code></b>
                  (<code>str</code>)
              –
              <div class="doc-md-description">
                <p>Name of the experiment to produce authentication for.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Returns:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
<b><code>auth</code></b>(                  <code><span title="requests.auth.HTTPBasicAuth">HTTPBasicAuth</span></code>
)              –
              <div class="doc-md-description">
                <p>HTTPBasicAuth for an active experiment based on
username and password for the associated operator account.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
            <details class="quote">
              <summary>Source code in <code>lute/io/elog.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_elog_opr_auth</span><span class="p">(</span><span class="n">exp</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">HTTPBasicAuth</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Produce authentication for the &quot;opr&quot; user associated to an experiment.</span>

<span class="sd">    This method uses basic authentication using username and password.</span>

<span class="sd">    Args:</span>
<span class="sd">        exp (str): Name of the experiment to produce authentication for.</span>

<span class="sd">    Returns:</span>
<span class="sd">        auth (HTTPBasicAuth): HTTPBasicAuth for an active experiment based on</span>
<span class="sd">            username and password for the associated operator account.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">opr</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">exp</span><span class="p">[:</span><span class="mi">3</span><span class="p">]</span><span class="si">}</span><span class="s2">opr&quot;</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;/sdf/group/lcls/ds/tools/forElogPost.txt&quot;</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="n">pw</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">readline</span><span class="p">()[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">HTTPBasicAuth</span><span class="p">(</span><span class="n">opr</span><span class="p">,</span> <span class="n">pw</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="io.elog.get_elog_params_by_run" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_elog_params_by_run</span><span class="p">(</span><span class="n">exp</span><span class="p">,</span> <span class="n">params</span><span class="p">,</span> <span class="n">runs</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

      <p>Retrieve requested parameters by run or for all runs.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>exp</code></b>
                  (<code>str</code>)
              –
              <div class="doc-md-description">
                <p>Experiment to retrieve parameters for.</p>
              </div>
            </li>
            <li>
              <b><code>params</code></b>
                  (<code><span title="typing.List">List</span>[str]</code>)
              –
              <div class="doc-md-description">
                <p>A list of parameters to retrieve. These can be any
parameter recorded in the eLog (PVs, parameters posted by other
Tasks, etc.)</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
            <details class="quote">
              <summary>Source code in <code>lute/io/elog.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">509</span>
<span class="normal">510</span>
<span class="normal">511</span>
<span class="normal">512</span>
<span class="normal">513</span>
<span class="normal">514</span>
<span class="normal">515</span>
<span class="normal">516</span>
<span class="normal">517</span>
<span class="normal">518</span>
<span class="normal">519</span>
<span class="normal">520</span>
<span class="normal">521</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_elog_params_by_run</span><span class="p">(</span>
    <span class="n">exp</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">params</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">runs</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Retrieve requested parameters by run or for all runs.</span>

<span class="sd">    Args:</span>
<span class="sd">        exp (str): Experiment to retrieve parameters for.</span>

<span class="sd">        params (List[str]): A list of parameters to retrieve. These can be any</span>
<span class="sd">            parameter recorded in the eLog (PVs, parameters posted by other</span>
<span class="sd">            Tasks, etc.)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="o">...</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="io.elog.get_elog_runs_by_tag" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_elog_runs_by_tag</span><span class="p">(</span><span class="n">exp</span><span class="p">,</span> <span class="n">tag</span><span class="p">,</span> <span class="n">auth</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

      <p>Retrieve run numbers with a specified tag.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>exp</code></b>
                  (<code>str</code>)
              –
              <div class="doc-md-description">
                <p>Experiment name.</p>
              </div>
            </li>
            <li>
              <b><code>tag</code></b>
                  (<code>str</code>)
              –
              <div class="doc-md-description">
                <p>The tag to retrieve runs for.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
            <details class="quote">
              <summary>Source code in <code>lute/io/elog.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">486</span>
<span class="normal">487</span>
<span class="normal">488</span>
<span class="normal">489</span>
<span class="normal">490</span>
<span class="normal">491</span>
<span class="normal">492</span>
<span class="normal">493</span>
<span class="normal">494</span>
<span class="normal">495</span>
<span class="normal">496</span>
<span class="normal">497</span>
<span class="normal">498</span>
<span class="normal">499</span>
<span class="normal">500</span>
<span class="normal">501</span>
<span class="normal">502</span>
<span class="normal">503</span>
<span class="normal">504</span>
<span class="normal">505</span>
<span class="normal">506</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_elog_runs_by_tag</span><span class="p">(</span>
    <span class="n">exp</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">tag</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">auth</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n">HTTPBasicAuth</span><span class="p">,</span> <span class="n">Dict</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Retrieve run numbers with a specified tag.</span>

<span class="sd">    Args:</span>
<span class="sd">        exp (str): Experiment name.</span>

<span class="sd">        tag (str): The tag to retrieve runs for.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">endpoint</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">exp</span><span class="si">}</span><span class="s2">/ws/get_runs_with_tag?tag=</span><span class="si">{</span><span class="n">tag</span><span class="si">}</span><span class="s2">&quot;</span>
    <span class="n">params</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="n">status_code</span><span class="p">,</span> <span class="n">resp_msg</span><span class="p">,</span> <span class="n">tagged_runs</span> <span class="o">=</span> <span class="n">elog_http_request</span><span class="p">(</span>
        <span class="n">exp</span><span class="o">=</span><span class="n">exp</span><span class="p">,</span> <span class="n">endpoint</span><span class="o">=</span><span class="n">endpoint</span><span class="p">,</span> <span class="n">request_type</span><span class="o">=</span><span class="s2">&quot;GET&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">params</span>
    <span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">tagged_runs</span><span class="p">:</span>
        <span class="n">tagged_runs</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">return</span> <span class="n">tagged_runs</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="io.elog.get_elog_workflows" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_elog_workflows</span><span class="p">(</span><span class="n">exp</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

      <p>Get the current workflow definitions for an experiment.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Returns:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
<b><code>defns</code></b>(                  <code><span title="typing.Dict">Dict</span>[str, str]</code>
)              –
              <div class="doc-md-description">
                <p>A dictionary of workflow definitions.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
            <details class="quote">
              <summary>Source code in <code>lute/io/elog.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_elog_workflows</span><span class="p">(</span><span class="n">exp</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Get the current workflow definitions for an experiment.</span>

<span class="sd">    Returns:</span>
<span class="sd">        defns (Dict[str, str]): A dictionary of workflow definitions.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">raise</span> <span class="ne">NotImplementedError</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="io.elog.post_elog_message" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">post_elog_message</span><span class="p">(</span><span class="n">exp</span><span class="p">,</span> <span class="n">msg</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">tag</span><span class="p">,</span> <span class="n">title</span><span class="p">,</span> <span class="n">in_files</span><span class="o">=</span><span class="p">[])</span></code>

</h2>


    <div class="doc doc-contents ">

      <p>Post a new message to the eLog. Inspired by the <code>elog</code> package.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>exp</code></b>
                  (<code>str</code>)
              –
              <div class="doc-md-description">
                <p>Experiment name.</p>
              </div>
            </li>
            <li>
              <b><code>msg</code></b>
                  (<code>str</code>)
              –
              <div class="doc-md-description">
                <p>BODY of the eLog post.</p>
              </div>
            </li>
            <li>
              <b><code>tag</code></b>
                  (<code>str | None</code>)
              –
              <div class="doc-md-description">
                <p>Optional "tag" to associate with the eLog post.</p>
              </div>
            </li>
            <li>
              <b><code>title</code></b>
                  (<code>str | None</code>)
              –
              <div class="doc-md-description">
                <p>Optional title to include in the eLog post.</p>
              </div>
            </li>
            <li>
              <b><code>in_files</code></b>
                  (<code><span title="typing.List">List</span>[str | tuple | list]</code>, default:
                      <code>[]</code>
)
              –
              <div class="doc-md-description">
                <p>Files to include as attachments in
the eLog post.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Returns:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
<b><code>err_msg</code></b>(                  <code>str | None</code>
)              –
              <div class="doc-md-description">
                <p>If successful, nothing is returned, otherwise,
return an error message.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
            <details class="quote">
              <summary>Source code in <code>lute/io/elog.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span>
<span class="normal">403</span>
<span class="normal">404</span>
<span class="normal">405</span>
<span class="normal">406</span>
<span class="normal">407</span>
<span class="normal">408</span>
<span class="normal">409</span>
<span class="normal">410</span>
<span class="normal">411</span>
<span class="normal">412</span>
<span class="normal">413</span>
<span class="normal">414</span>
<span class="normal">415</span>
<span class="normal">416</span>
<span class="normal">417</span>
<span class="normal">418</span>
<span class="normal">419</span>
<span class="normal">420</span>
<span class="normal">421</span>
<span class="normal">422</span>
<span class="normal">423</span>
<span class="normal">424</span>
<span class="normal">425</span>
<span class="normal">426</span>
<span class="normal">427</span>
<span class="normal">428</span>
<span class="normal">429</span>
<span class="normal">430</span>
<span class="normal">431</span>
<span class="normal">432</span>
<span class="normal">433</span>
<span class="normal">434</span>
<span class="normal">435</span>
<span class="normal">436</span>
<span class="normal">437</span>
<span class="normal">438</span>
<span class="normal">439</span>
<span class="normal">440</span>
<span class="normal">441</span>
<span class="normal">442</span>
<span class="normal">443</span>
<span class="normal">444</span>
<span class="normal">445</span>
<span class="normal">446</span>
<span class="normal">447</span>
<span class="normal">448</span>
<span class="normal">449</span>
<span class="normal">450</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">post_elog_message</span><span class="p">(</span>
    <span class="n">exp</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">msg</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">tag</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
    <span class="n">title</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
    <span class="n">in_files</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">,</span> <span class="nb">list</span><span class="p">]]</span> <span class="o">=</span> <span class="p">[],</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Post a new message to the eLog. Inspired by the `elog` package.</span>

<span class="sd">    Args:</span>
<span class="sd">        exp (str): Experiment name.</span>

<span class="sd">        msg (str): BODY of the eLog post.</span>

<span class="sd">        tag (str | None): Optional &quot;tag&quot; to associate with the eLog post.</span>

<span class="sd">        title (str | None): Optional title to include in the eLog post.</span>

<span class="sd">        in_files (List[str | tuple | list]): Files to include as attachments in</span>
<span class="sd">            the eLog post.</span>

<span class="sd">    Returns:</span>
<span class="sd">        err_msg (str | None): If successful, nothing is returned, otherwise,</span>
<span class="sd">            return an error message.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># MOSTLY CORRECT</span>
    <span class="n">out_files</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">in_files</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">out_files</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">format_file_for_post</span><span class="p">(</span><span class="n">in_file</span><span class="o">=</span><span class="n">f</span><span class="p">))</span>
        <span class="k">except</span> <span class="n">ElogFileFormatError</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;ElogFileFormatError: </span><span class="si">{</span><span class="n">err</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">post</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">post</span><span class="p">[</span><span class="s2">&quot;log_text&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">msg</span>
    <span class="k">if</span> <span class="n">tag</span><span class="p">:</span>
        <span class="n">post</span><span class="p">[</span><span class="s2">&quot;log_tags&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">tag</span>
    <span class="k">if</span> <span class="n">title</span><span class="p">:</span>
        <span class="n">post</span><span class="p">[</span><span class="s2">&quot;log_title&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">title</span>

    <span class="n">endpoint</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">exp</span><span class="si">}</span><span class="s2">/ws/new_elog_entry&quot;</span>

    <span class="n">params</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;data&quot;</span><span class="p">:</span> <span class="n">post</span><span class="p">}</span>

    <span class="k">if</span> <span class="n">out_files</span><span class="p">:</span>
        <span class="n">params</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s2">&quot;files&quot;</span><span class="p">:</span> <span class="n">out_files</span><span class="p">})</span>

    <span class="n">status_code</span><span class="p">,</span> <span class="n">resp_msg</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">elog_http_request</span><span class="p">(</span>
        <span class="n">exp</span><span class="o">=</span><span class="n">exp</span><span class="p">,</span> <span class="n">endpoint</span><span class="o">=</span><span class="n">endpoint</span><span class="p">,</span> <span class="n">request_type</span><span class="o">=</span><span class="s2">&quot;POST&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">params</span>
    <span class="p">)</span>

    <span class="k">if</span> <span class="n">resp_msg</span> <span class="o">!=</span> <span class="s2">&quot;SUCCESS&quot;</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">resp_msg</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="io.elog.post_elog_run_status" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">post_elog_run_status</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">update_url</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

      <p>Post a summary to the status/report section of a specific run.</p>
<p>In contrast to most eLog update/post mechanisms, this function searches
for a specific environment variable which contains a specific URL for
posting. This is updated every job/run as jobs are submitted by the JID.
The URL can optionally be passed to this function if it is known.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>data</code></b>
                  (<code><span title="typing.Dict">Dict</span>[str, <span title="typing.Union">Union</span>[str, int, float]]</code>)
              –
              <div class="doc-md-description">
                <p>The data to post to the eLog
report section. Formatted in key:value pairs.</p>
              </div>
            </li>
            <li>
              <b><code>update_url</code></b>
                  (<code><span title="typing.Optional">Optional</span>[str]</code>, default:
                      <code>None</code>
)
              –
              <div class="doc-md-description">
                <p>Optional update URL. If not provided, the
function searches for the corresponding environment variable. If
neither is found, the function aborts</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
            <details class="quote">
              <summary>Source code in <code>lute/io/elog.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">post_elog_run_status</span><span class="p">(</span>
    <span class="n">data</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">]],</span> <span class="n">update_url</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Post a summary to the status/report section of a specific run.</span>

<span class="sd">    In contrast to most eLog update/post mechanisms, this function searches</span>
<span class="sd">    for a specific environment variable which contains a specific URL for</span>
<span class="sd">    posting. This is updated every job/run as jobs are submitted by the JID.</span>
<span class="sd">    The URL can optionally be passed to this function if it is known.</span>

<span class="sd">    Args:</span>
<span class="sd">        data (Dict[str, Union[str, int, float]]): The data to post to the eLog</span>
<span class="sd">            report section. Formatted in key:value pairs.</span>

<span class="sd">        update_url (Optional[str]): Optional update URL. If not provided, the</span>
<span class="sd">            function searches for the corresponding environment variable. If</span>
<span class="sd">            neither is found, the function aborts</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">update_url</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">update_url</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;JID_UPDATE_COUNTERS&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">update_url</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;eLog Update Failed! JID_UPDATE_COUNTERS is not defined!&quot;</span><span class="p">)</span>
            <span class="k">return</span>
    <span class="n">current_status</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">]]</span> <span class="o">=</span> <span class="n">_get_current_run_status</span><span class="p">(</span>
        <span class="n">update_url</span>
    <span class="p">)</span>
    <span class="n">current_status</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
    <span class="n">post_list</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="p">[</span>
        <span class="p">{</span><span class="s2">&quot;key&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="s2">&quot;value&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">value</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">}</span> <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">current_status</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
    <span class="p">]</span>
    <span class="n">params</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]]]</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;json&quot;</span><span class="p">:</span> <span class="n">post_list</span><span class="p">}</span>
    <span class="n">resp</span><span class="p">:</span> <span class="n">requests</span><span class="o">.</span><span class="n">models</span><span class="o">.</span><span class="n">Response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="n">update_url</span><span class="p">,</span> <span class="o">**</span><span class="n">params</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="io.elog.post_elog_run_table" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">post_elog_run_table</span><span class="p">(</span><span class="n">exp</span><span class="p">,</span> <span class="n">run</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

      <p>Post data for eLog run tables.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>exp</code></b>
                  (<code>str</code>)
              –
              <div class="doc-md-description">
                <p>Experiment name.</p>
              </div>
            </li>
            <li>
              <b><code>run</code></b>
                  (<code>int</code>)
              –
              <div class="doc-md-description">
                <p>Run number corresponding to the data being posted.</p>
              </div>
            </li>
            <li>
              <b><code>data</code></b>
                  (<code><span title="typing.Dict">Dict</span>[str, <span title="typing.Any">Any</span>]</code>)
              –
              <div class="doc-md-description">
                <p>Data to be posted in format
data["column_header"] = value.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Returns:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
<b><code>err_msg</code></b>(                  <code>None | str</code>
)              –
              <div class="doc-md-description">
                <p>If successful, nothing is returned, otherwise,
return an error message.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
            <details class="quote">
              <summary>Source code in <code>lute/io/elog.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">454</span>
<span class="normal">455</span>
<span class="normal">456</span>
<span class="normal">457</span>
<span class="normal">458</span>
<span class="normal">459</span>
<span class="normal">460</span>
<span class="normal">461</span>
<span class="normal">462</span>
<span class="normal">463</span>
<span class="normal">464</span>
<span class="normal">465</span>
<span class="normal">466</span>
<span class="normal">467</span>
<span class="normal">468</span>
<span class="normal">469</span>
<span class="normal">470</span>
<span class="normal">471</span>
<span class="normal">472</span>
<span class="normal">473</span>
<span class="normal">474</span>
<span class="normal">475</span>
<span class="normal">476</span>
<span class="normal">477</span>
<span class="normal">478</span>
<span class="normal">479</span>
<span class="normal">480</span>
<span class="normal">481</span>
<span class="normal">482</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">post_elog_run_table</span><span class="p">(</span>
    <span class="n">exp</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">run</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
    <span class="n">data</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">],</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Post data for eLog run tables.</span>

<span class="sd">    Args:</span>
<span class="sd">        exp (str): Experiment name.</span>

<span class="sd">        run (int): Run number corresponding to the data being posted.</span>

<span class="sd">        data (Dict[str, Any]): Data to be posted in format</span>
<span class="sd">            data[&quot;column_header&quot;] = value.</span>

<span class="sd">    Returns:</span>
<span class="sd">        err_msg (None | str): If successful, nothing is returned, otherwise,</span>
<span class="sd">            return an error message.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">endpoint</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;run_control/</span><span class="si">{</span><span class="n">exp</span><span class="si">}</span><span class="s2">/ws/add_run_params&quot;</span>

    <span class="n">params</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;params&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;run_num&quot;</span><span class="p">:</span> <span class="n">run</span><span class="p">},</span> <span class="s2">&quot;json&quot;</span><span class="p">:</span> <span class="n">data</span><span class="p">}</span>

    <span class="n">status_code</span><span class="p">,</span> <span class="n">resp_msg</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">elog_http_request</span><span class="p">(</span>
        <span class="n">exp</span><span class="o">=</span><span class="n">exp</span><span class="p">,</span> <span class="n">endpoint</span><span class="o">=</span><span class="n">endpoint</span><span class="p">,</span> <span class="n">request_type</span><span class="o">=</span><span class="s2">&quot;POST&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">params</span>
    <span class="p">)</span>

    <span class="k">if</span> <span class="n">resp_msg</span> <span class="o">!=</span> <span class="s2">&quot;SUCCESS&quot;</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">resp_msg</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="io.elog.post_elog_workflow" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">post_elog_workflow</span><span class="p">(</span><span class="n">exp</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">executable</span><span class="p">,</span> <span class="n">wf_params</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">trigger</span><span class="o">=</span><span class="s1">&#39;run_end&#39;</span><span class="p">,</span> <span class="n">location</span><span class="o">=</span><span class="s1">&#39;S3DF&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">trig_args</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

      <p>Create a new eLog workflow, or update an existing one.</p>
<p>The workflow will run a specific executable as a batch job when the
specified trigger occurs. The precise arguments may vary depending on the
selected trigger type.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>name</code></b>
                  (<code>str</code>)
              –
              <div class="doc-md-description">
                <p>An identifying name for the workflow. E.g. "process data"</p>
              </div>
            </li>
            <li>
              <b><code>executable</code></b>
                  (<code>str</code>)
              –
              <div class="doc-md-description">
                <p>Full path to the executable to be run.</p>
              </div>
            </li>
            <li>
              <b><code>wf_params</code></b>
                  (<code>str</code>)
              –
              <div class="doc-md-description">
                <p>All command-line parameters for the executable as a string.</p>
              </div>
            </li>
            <li>
              <b><code>trigger</code></b>
                  (<code>str</code>, default:
                      <code>&#39;run_end&#39;</code>
)
              –
              <div class="doc-md-description">
                <p>When to trigger execution of the specified executable.
One of:
    - 'manual': Must be manually triggered. No automatic processing.
    - 'run_start': Execute immediately if a new run begins.
    - 'run_end': As soon as a run ends.
    - 'param_is': As soon as a parameter has a specific value for a run.</p>
              </div>
            </li>
            <li>
              <b><code>location</code></b>
                  (<code>str</code>, default:
                      <code>&#39;S3DF&#39;</code>
)
              –
              <div class="doc-md-description">
                <p>Where to submit the job. S3DF or NERSC.</p>
              </div>
            </li>
            <li>
              <b><code>**trig_args</code></b>
                  (<code>str</code>, default:
                      <code>{}</code>
)
              –
              <div class="doc-md-description">
                <p>Arguments required for a specific trigger type.
trigger='param_is' - 2 Arguments
    trig_param (str): Name of the parameter to watch for.
    trig_param_val (str): Value the parameter should have to trigger.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
            <details class="quote">
              <summary>Source code in <code>lute/io/elog.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">post_elog_workflow</span><span class="p">(</span>
    <span class="n">exp</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">executable</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">wf_params</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">trigger</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;run_end&quot;</span><span class="p">,</span>
    <span class="n">location</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;S3DF&quot;</span><span class="p">,</span>
    <span class="o">**</span><span class="n">trig_args</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Create a new eLog workflow, or update an existing one.</span>

<span class="sd">    The workflow will run a specific executable as a batch job when the</span>
<span class="sd">    specified trigger occurs. The precise arguments may vary depending on the</span>
<span class="sd">    selected trigger type.</span>

<span class="sd">    Args:</span>
<span class="sd">        name (str): An identifying name for the workflow. E.g. &quot;process data&quot;</span>

<span class="sd">        executable (str): Full path to the executable to be run.</span>

<span class="sd">        wf_params (str): All command-line parameters for the executable as a string.</span>

<span class="sd">        trigger (str): When to trigger execution of the specified executable.</span>
<span class="sd">            One of:</span>
<span class="sd">                - &#39;manual&#39;: Must be manually triggered. No automatic processing.</span>
<span class="sd">                - &#39;run_start&#39;: Execute immediately if a new run begins.</span>
<span class="sd">                - &#39;run_end&#39;: As soon as a run ends.</span>
<span class="sd">                - &#39;param_is&#39;: As soon as a parameter has a specific value for a run.</span>

<span class="sd">        location (str): Where to submit the job. S3DF or NERSC.</span>

<span class="sd">        **trig_args (str): Arguments required for a specific trigger type.</span>
<span class="sd">            trigger=&#39;param_is&#39; - 2 Arguments</span>
<span class="sd">                trig_param (str): Name of the parameter to watch for.</span>
<span class="sd">                trig_param_val (str): Value the parameter should have to trigger.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">endpoint</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">exp</span><span class="si">}</span><span class="s2">/ws/create_update_workflow_def&quot;</span>
    <span class="n">trig_map</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;manual&quot;</span><span class="p">:</span> <span class="s2">&quot;MANUAL&quot;</span><span class="p">,</span>
        <span class="s2">&quot;run_start&quot;</span><span class="p">:</span> <span class="s2">&quot;START_OF_RUN&quot;</span><span class="p">,</span>
        <span class="s2">&quot;run_end&quot;</span><span class="p">:</span> <span class="s2">&quot;END_OF_RUN&quot;</span><span class="p">,</span>
        <span class="s2">&quot;param_is&quot;</span><span class="p">:</span> <span class="s2">&quot;RUN_PARAM_IS_VALUE&quot;</span><span class="p">,</span>
    <span class="p">}</span>
    <span class="k">if</span> <span class="n">trigger</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">trig_map</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;Cannot create workflow with trigger type: </span><span class="si">{</span><span class="n">trigger</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="p">)</span>
    <span class="n">wf_defn</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="n">name</span><span class="p">,</span>
        <span class="s2">&quot;executable&quot;</span><span class="p">:</span> <span class="n">executable</span><span class="p">,</span>
        <span class="s2">&quot;parameters&quot;</span><span class="p">:</span> <span class="n">wf_params</span><span class="p">,</span>
        <span class="s2">&quot;trigger&quot;</span><span class="p">:</span> <span class="n">trig_map</span><span class="p">[</span><span class="n">trigger</span><span class="p">],</span>
        <span class="s2">&quot;location&quot;</span><span class="p">:</span> <span class="n">location</span><span class="p">,</span>
    <span class="p">}</span>
    <span class="k">if</span> <span class="n">trigger</span> <span class="o">==</span> <span class="s2">&quot;param_is&quot;</span><span class="p">:</span>
        <span class="k">if</span> <span class="s2">&quot;trig_param&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">trig_args</span> <span class="ow">or</span> <span class="s2">&quot;trig_param_val&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">trig_args</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span>
                <span class="s2">&quot;Trigger type &#39;param_is&#39; requires: &#39;trig_param&#39; and &#39;trig_param_val&#39; arguments&quot;</span>
            <span class="p">)</span>
        <span class="n">wf_defn</span><span class="o">.</span><span class="n">update</span><span class="p">(</span>
            <span class="p">{</span>
                <span class="s2">&quot;run_param_name&quot;</span><span class="p">:</span> <span class="n">trig_args</span><span class="p">[</span><span class="s2">&quot;trig_param&quot;</span><span class="p">],</span>
                <span class="s2">&quot;run_param_val&quot;</span><span class="p">:</span> <span class="n">trig_args</span><span class="p">[</span><span class="s2">&quot;trig_param_val&quot;</span><span class="p">],</span>
            <span class="p">}</span>
        <span class="p">)</span>
    <span class="n">post_params</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;json&quot;</span><span class="p">:</span> <span class="n">wf_defn</span><span class="p">}</span>
    <span class="n">status_code</span><span class="p">,</span> <span class="n">resp_msg</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">elog_http_request</span><span class="p">(</span>
        <span class="n">exp</span><span class="p">,</span> <span class="n">endpoint</span><span class="o">=</span><span class="n">endpoint</span><span class="p">,</span> <span class="n">request_type</span><span class="o">=</span><span class="s2">&quot;POST&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">post_params</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>
              
            </div>
          </div><footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="Footer Navigation">
        <a href="../_sqlite/" class="btn btn-neutral float-left" title="_sqlite"><span class="icon icon-circle-arrow-left"></span> Previous</a>
        <a href="../exceptions/" class="btn btn-neutral float-right" title="exceptions">Next <span class="icon icon-circle-arrow-right"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
      <p>© 2024 LCLS</p>
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
          
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
        <span>
          <a href="https://github.com/slac-lcls/lute" class="fa fa-github" style="color: #fcfcfc"> GitHub</a>
        </span>
    
    
      <span><a href="../_sqlite/" style="color: #fcfcfc">&laquo; Previous</a></span>
    
    
      <span><a href="../exceptions/" style="color: #fcfcfc">Next &raquo;</a></span>
    
  </span>
</div>
    <script>var base_url = '../../..';</script>
    <script src="../../../js/theme_extra.js" defer></script>
    <script src="../../../js/theme.js" defer></script>
      <script src="../../../search/main.js" defer></script>
      <script src="../../../js/version-select.js" defer></script>
    <script defer>
        window.onload = function () {
            SphinxRtdTheme.Navigation.enable(true);
        };
    </script>

</body>
</html>
